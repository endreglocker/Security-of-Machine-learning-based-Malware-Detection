#!/bin/bash
#

NUMBER_OF_FILES=$(ls -1 dataset/*/* | wc -l)

NUMBER_OF_FILES=$(($NUMBER_OF_FILES * 3 / 16))

#echo $NUMBER_OF_FILES

if [ -d "model/data/training/" ]; then
    rm -r model/data/training/
fi

mkdir -p model/data/training/

if [ -f model/data/training.csv ]; then
    rm model/data/training.csv
fi

touch model/data/training.csv
echo "filename,label" >> model/data/training.csv

count=0
for type in dataset/*; do
    dirname_of_type=$(basename "$type")
    echo $type
    for arch in $type/*; do
        echo $arch
        for file in $arch/*; do
            filename=$(basename "$file")
            if [ "$dirname_of_type" = "malware" ]; then
                echo "$filename,1" >> model/data/training.csv
            elif [ "$dirname_of_type" = "benign" ]; then
                echo "$filename,0" >> model/data/training.csv
            fi
            cp $file model/data/training/
            count=$((count + 1))
            #if [ $count -ge $NUMBER_OF_FILES ]; then
            #    break
            #fi
        done
        count=0
    done
done
       